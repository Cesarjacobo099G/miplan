<!DOCTYPE html>
<html lang="en" class="h-100" data-bs-theme="auto">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anxity</title>
    <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="./node_modules/bootstrap-icons/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="./assets/css/style.css">
    <link rel="stylesheet" href="./assets/css/anxity.css">
    <link rel="stylesheet" href="./assets/css/fondo.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script>
        (function () {
            window.onload = function () {
                const preloader = document.querySelector('.page-loading');
                preloader.classList.remove('active');
                setTimeout(function () {
                    preloader.remove();
                }, 1000);
            };
        })();
    </script>
</head>

<body class="d-flex h-50 text-bg-principal">

    <!--LOADING-->
    <div class="page-loading active">
        <div class="page-loading-inner">
            <div class="page-spinner"></div><span>Cargando...</span>
        </div>
    </div>

    <svg class="fondo" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" viewBox="0 0 100 100">
        <defs>

            <!-- Gradiente Lineal para el primer path -->
            <linearGradient id="gradienteAzul" x1="100%" y1="100%" x2="0%" y2="0%">
                <stop offset="0%" style="stop-color:rgb(165, 162, 255); stop-opacity:1" />
                <stop offset="100%" style="stop-color:#22127d; stop-opacity:1" />
            </linearGradient>
            <!-- Gradiente Lineal para el segundo path -->
            <linearGradient id="gradienteRosa" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#b1bac9; stop-opacity:1" />
                <stop offset="100%" style="stop-color:#272dcb; stop-opacity:1" />
            </linearGradient>
            <!-- Gradiente Radial para el tercer path -->
            <radialGradient id="gradienteRosaRadial" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                <stop offset="0%" style="stop-color:#dddbfe; stop-opacity:1" />
                <stop offset="100%" style="stop-color:#2c1a8e; stop-opacity:1" />
            </radialGradient>
            <!-- Gradiente Radial para el cuarto path -->
            <radialGradient id="gradienteAzulRadial" cx="50%" cy="50%" r="50%" fx="50%" fy="50%">
                <stop offset="0%" style="stop-color:#d3e2fa; stop-opacity:1" />
                <stop offset="100%" style="stop-color:#1f4f8b; stop-opacity:1" />
            </radialGradient>
        </defs>

        <!-- Usar los Gradientes en los Paths -->
        <path fill="url(#gradienteAzul)" class="naranja"
            d="m38.52809,-5c-12.1832,-9.7 -32.04489,-14.1 -47.29949,-5c-19.75931,11.8 -24.05926,41.1 -10.85226,59c15.86888,21.5 53.8518,22 68.79926,2.3c12.28558,-16.3 6.44993,-42.8 -10.6475,-56.3z" />
        <path fill="url(#gradienteRosa)" class="amarillo"
            d="m23.53736,4.22653c-9.82841,-2.86149 -24.57103,-1.76091 -31.23251,7.81406c-9.06398,13.0968 -0.21841,37.85966 16.81751,42.70217s37.89399,-12.21634 36.69274,-28.06457c-0.87364,-11.44594 -12.66773,-19.70023 -22.27773,-22.45166z" />
        <path fill="url(#gradienteRosaRadial)" class="rosa"
            d="m105.9,50.88357c-12.4,-7.98865 -29.3,-4.67628 -39.4,0.77938c-23.4,12.47008 -37.7,50.56228 -19.1,72.19008s63.9,14.90564 76,-5.45566c7.6,-12.95719 1.8,-30.2984 -2.3,-42.67106c-3.5,-10.52163 -6.4,-19.28966 -15.2,-24.84274z" />
        <path fill="url(#gradienteAzulRadial)" class="azul"
            d="m101.37962,63.69679c-10.14754,-6.47895 -23.25478,-3.29258 -31.18255,2.12425c-16.27835,11.36472 -20.7179,39.82961 -8.03347,50.76948s37.94758,4.14228 47.03808,-13.27654c6.44792,-12.53305 4.75666,-31.65126 -7.82206,-39.61719z" />
    </svg>
    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column">
        <!-- HEADER -->
        <header class="mb-auto py-3">
            <div class="d-flex justify-content-between align-items-center">
                <a href="./index.html" class="nabla text-decoration-none">
                    <h3 class="mb-0 nabla">MIPLAN</h3>
                </a>
                <button class="navbar-toggler d-md-none" type="button" data-bs-toggle="offcanvas"
                    data-bs-target="#offcanvasNavbar" aria-controls="offcanvasNavbar">
                    <i class="bi bi-list text-titulos"></i>
                </button>
                <nav class="nav nav-masthead justify-content-center d-none d-md-flex">
                    <a class="nav-link fw-bold py-1 px-0" aria-current="page" href="./index.html">Inicio</a>
                    <a class="nav-link fw-bold py-1 px-0" aria-current="page" href="./apoyo.html">Apoyo</a>
                    <a class="nav-link fw-bold py-1 px-0" href="./blog.html">Blog</a>
                    <a class="nav-link fw-bold py-1 px-0" href="./descubrir.html">Descubrir</a>
                </nav>
            </div>
        </header>
        <!-- FIN HEADER -->

        <!-- HEADER OFFCANVAS -->
        <div class="offcanvas offcanvas-end bg-principal" tabindex="-1" id="offcanvasNavbar"
            aria-labelledby="offcanvasNavbarLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title text-start nabla" id="offcanvasNavbarLabel">MIPLAN</h5>
                <svg xmlns="http://www.w3.org/2000/svg" type="button" data-bs-dismiss="offcanvas" width="16" height="16"
                    fill="currentColor" class="bi bi-x-lg btn-close text-reset text-titulos" aria-label="Close"
                    viewBox="0 0 16 16">
                    <path
                        d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z" />
                </svg>
            </div>
            <div class="offcanvas-body">
                <nav class="nav flex-column text-start">
                    <a class="nav-link fw-bold py-1 text-titulos px-0" aria-current="page"
                        href="./index.html">Inicio</a>
                    <a class="nav-link fw-bold py-1 text-titulos px-0" aria-current="page"
                        href="./apoyo.html">Apoyo</a>
                    <a class="nav-link fw-bold py-1 text-titulos px-0" href="./blog.html">Blog</a>
                    <a class="nav-link fw-bold py-1 text-titulos px-0" href="./descubrir.html">Descubrir</a>
                </nav>
            </div>
            <!-- FOOTER OFFCANVAS -->
            <div class="offcanvas-footer">
                <a href="./login.html"
                    class="btn fw-bold rounded-pill bg-botones text-titulos mt-3 btn-offcanvas">INICIA
                    MIPLAN</a>
            </div>
        </div>
        <!-- FIN HEADER OFFCANVAS -->

        <!-- REGISTRO -->
        <section class="py-3 py-md-1 py-xl-8">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="mb-5">
                            <h2 class="display-5 fw-bold text-center text-titulos">Crear una cuenta</h2>
                            <p class="text-center m-0"><a class="text-titulos" href="./login.html">Ya tengo mi
                                    cuenta</a>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col-12 col-lg-10 col-xl-8">
                        <div class="row gy-5 justify-content-center">
                            <!-- FORMULARIO -->
                            <div class="col-12 col-lg-5">
                                <form id="registerForm" class="needs-validation" novalidate>
                                    <div class="row gy-2 overflow-hidden">
                                        <div class="col-12">
                                            <label for="email" class="form-label text-letras josefin-sans">CORREO
                                                ELECTRÓNICO</label>
                                            <input type="email" class="form-control" id="email" required>
                                            <div class="invalid-feedback josefin-sans">Requerido.</div>
                                        </div>
                                        <div class="col-12">
                                            <label for="username" class="form-label text-letras josefin-sans">NOMBRE DE
                                                USUARIO</label>
                                            <input type="text" class="form-control" id="username" required>
                                            <div class="invalid-feedback josefin-sans">Requerido.</div>
                                        </div>
                                        <div class="col-12">
                                            <label for="userType" class="form-label text-letras josefin-sans">TIPO DE
                                                USUARIO</label>
                                            <select class="form-control" id="userType" required>
                                                <option value="" disabled selected>Selecciona una opción</option>
                                                <option value="estudiante">Estudiante</option>
                                                <option value="docente">Docente</option>
                                            </select>
                                            <div class="invalid-feedback josefin-sans">Requerido.</div>
                                        </div>
                                        <div class="col-12">
                                            <label for="birthdate" class="form-label text-letras josefin-sans">FECHA DE
                                                NACIMIENTO</label>
                                            <input type="date" class="form-control" id="birthdate" required>
                                            <div class="invalid-feedback josefin-sans">Requerido.</div>
                                        </div>
                                        <div class="col-12">
                                            <label for="password"
                                                class="form-label text-letras josefin-sans">CONTRASEÑA</label>
                                            <input type="password" class="form-control" id="password" required>
                                            <div class="invalid-feedback josefin-sans">Requerido.</div>
                                        </div>
                                        <div class="col-12">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="terms" required>
                                                <label style="font-size: 0.8rem;" class="form-check-label text-titulos"
                                                    for="terms">
                                                    Leí y acepto las <a href="#" class="text-letras">Condiciones del
                                                        Servicio</a> y la
                                                    <a href="#" class="text-letras">Política de Privacidad</a>.
                                                </label>
                                                <div class="invalid-feedback josefin-sans">Debes aceptar los términos.
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-12">
                                            <div class="d-grid">
                                                <button class="btn btn-botones text-titulos btn-lg"
                                                    type="submit">Continuar</button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <!-- FIN FORMULARIO -->
                            <div
                                class="col-12 col-lg-2 d-flex align-items-center justify-content-center gap-3 flex-lg-column">
                                <div class="bg-titulos h-100 d-none d-lg-block"
                                    style="width: 1px; --bs-bg-opacity: .1;">
                                </div>
                                <div class="bg-titulos w-100 d-lg-none" style="height: 1px; --bs-bg-opacity: .1;"></div>
                                <div class="text-titulos">o</div>
                                <div class="bg-titulos h-100 d-none d-lg-block"
                                    style="width: 1px; --bs-bg-opacity: .1;">
                                </div>
                                <div class="bg-titulos w-100 d-lg-none" style="height: 1px; --bs-bg-opacity: .1;"></div>
                            </div>
                            <!-- OTRAS FORMAS DE INICIAR SESIÓN -->
                            <div class="col-12 col-lg-5 d-flex align-items-center">
                                <div class="d-flex gap-3 flex-column w-100 ">
                                    <a href="#!" class="btn btn-lg btn-danger">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            fill="currentColor" class="bi bi-google" viewBox="0 0 16 16">
                                            <path
                                                d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z" />
                                        </svg>
                                        <span class="ms-2 fs-6">Continuar con Google</span>
                                    </a>
                                    <a href="#!" class="btn btn-lg btn-primary">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                                            fill="currentColor" class="bi bi-facebook" viewBox="0 0 16 16">
                                            <path
                                                d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951z" />
                                        </svg>
                                        <span class="ms-2 fs-6">Continuar con Facebook</span>
                                    </a>
                                </div>
                            </div>
                            <!-- FIN FORMAS DE INICIAR SESIÓN -->
                        </div>
                    </div>
                </div>
            </div>
        </section> <br><br><br><br>
        <!-- FIN REGISTRO -->
    </div>

    <!-- Modal de alerta -->
    <div class="modal fade" id="alertModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="alertModalTitle">Alerta</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="alertModalMessage">
                    Mensaje de alerta aquí.
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>



    <script>
        // Configuración de Firebase (REEMPLAZA con tus credenciales)
        const firebaseConfig = {
            apiKey: "AIzaSyCoA7PD6tresjfdvhpnjHbJ58EirIODHFg",
            authDomain: "aplicacionweb20sep.firebaseapp.com",
            databaseURL: "https://aplicacionweb20sep-default-rtdb.firebaseio.com",
            projectId: "aplicacionweb20sep",
            storageBucket: "aplicacionweb20sep.appspot.com",
            messagingSenderId: "490646915921",
            appId: "1:490646915921:web:15055a7f0ad1acf06da170",
            measurementId: "G-R9719EJQ53"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);

        // Función para mostrar modales de alerta
        function showAlert(title, message) {
            document.getElementById("alertModalTitle").innerText = title;
            document.getElementById("alertModalMessage").innerText = message;
            var alertModal = new bootstrap.Modal(document.getElementById('alertModal'));
            alertModal.show();
        }

        // Manejo del formulario de registro
        document.getElementById("registerForm").addEventListener("submit", function (e) {
            e.preventDefault();

            // Obtener valores del formulario
            var email = document.getElementById("email").value;
            var username = document.getElementById("username").value;
            var userType = document.getElementById("userType").value;
            var birthdate = document.getElementById("birthdate").value;
            var password = document.getElementById("password").value;
            var termsAccepted = document.getElementById("terms").checked;

            if (!termsAccepted) {
                showAlert("Error", "Debes aceptar los términos y condiciones.");
                return;
            }

            // Verificar si el nombre de usuario ya existe en la base de datos
            var usersRef = firebase.database().ref("usuarios");
            usersRef.orderByChild("username").equalTo(username).once("value", function (snapshot) {
                if (snapshot.exists()) {
                    showAlert("Error", "El nombre de usuario ya está registrado. Intenta con otro.");
                } else {
                    // Crear usuario en Firebase Authentication
                    firebase.auth().createUserWithEmailAndPassword(email, password)
                        .then(function (userCredential) {
                            var user = userCredential.user;

                            // Guardar información en Firebase Database
                            return firebase.database().ref("usuarios/" + user.uid).set({
                                email: email,
                                username: username,
                                userType: userType,
                                birthdate: birthdate
                            });
                        })
                        .then(function () {
                            showAlert("Registro Exitoso", "Tu cuenta ha sido creada correctamente.");
                            setTimeout(() => {
                                window.location.href = "./user/user.html"; // Redirige a otra página después de 2s
                            }, 2000);
                        })
                        .catch(function (error) {
                            showAlert("Error", error.message);
                        });
                }
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>
    <script src="./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="./assets/js/main.js"></script>
    <script src="./assets/js/validacion.js"></script>
</body>

</html>